import{k as J,r as n,l as T,m as X,j as e,n as M,o as z,p as G,q as Q,s as F,t as U,z as b,c as Z,h as $,v as W,w as Y,x as ee,y as C,D as k,E as v,G as g,I as w,K as y,M as se,O as te,L as A,B as re,Q as oe,J as D}from"./index-D2Ipw2YP.js";import{u as ae}from"./index-DByQH1EK.js";var L="Checkbox",[ne,he]=J(L),[ce,ie]=ne(L),V=n.forwardRef((s,i)=>{const{__scopeCheckbox:r,name:d,checked:h,defaultChecked:a,required:o,disabled:l,value:f="on",onCheckedChange:t,form:u,...E}=s,[m,N]=n.useState(null),P=T(i,c=>N(c)),R=n.useRef(!1),I=m?u||!!m.closest("form"):!0,[x=!1,S]=X({prop:h,defaultProp:a,onChange:t}),H=n.useRef(x);return n.useEffect(()=>{const c=m==null?void 0:m.form;if(c){const j=()=>S(H.current);return c.addEventListener("reset",j),()=>c.removeEventListener("reset",j)}},[m,S]),e.jsxs(ce,{scope:r,state:x,disabled:l,children:[e.jsx(M.button,{type:"button",role:"checkbox","aria-checked":p(x)?"mixed":x,"aria-required":o,"data-state":_(x),"data-disabled":l?"":void 0,disabled:l,value:f,...E,ref:P,onKeyDown:z(s.onKeyDown,c=>{c.key==="Enter"&&c.preventDefault()}),onClick:z(s.onClick,c=>{S(j=>p(j)?!0:!j),I&&(R.current=c.isPropagationStopped(),R.current||c.stopPropagation())})}),I&&e.jsx(le,{control:m,bubbles:!R.current,name:d,value:f,checked:x,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"},defaultChecked:p(a)?!1:a})]})});V.displayName=L;var B="CheckboxIndicator",O=n.forwardRef((s,i)=>{const{__scopeCheckbox:r,forceMount:d,...h}=s,a=ie(B,r);return e.jsx(G,{present:d||p(a.state)||a.state===!0,children:e.jsx(M.span,{"data-state":_(a.state),"data-disabled":a.disabled?"":void 0,...h,ref:i,style:{pointerEvents:"none",...s.style}})})});O.displayName=B;var le=s=>{const{control:i,checked:r,bubbles:d=!0,defaultChecked:h,...a}=s,o=n.useRef(null),l=ae(r),f=Q(i);n.useEffect(()=>{const u=o.current,E=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(E,"checked").set;if(l!==r&&N){const P=new Event("click",{bubbles:d});u.indeterminate=p(r),N.call(u,p(r)?!1:r),u.dispatchEvent(P)}},[l,r,d]);const t=n.useRef(p(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:h??t.current,...a,tabIndex:-1,ref:o,style:{...s.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function p(s){return s==="indeterminate"}function _(s){return p(s)?"indeterminate":s?"checked":"unchecked"}var q=V,de=O;const K=n.forwardRef(({className:s,...i},r)=>e.jsx(q,{ref:r,className:F("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...i,children:e.jsx(de,{className:F("flex items-center justify-center text-current"),children:e.jsx(U,{className:"h-4 w-4"})})}));K.displayName=q.displayName;const ue=b.object({firstName:b.string().min(2,"Le prénom doit contenir au moins 2 caractères"),lastName:b.string().min(2,"Le nom doit contenir au moins 2 caractères"),email:b.string().email("Adresse email invalide"),password:b.string().min(8,"Le mot de passe doit contenir au moins 8 caractères").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Le mot de passe doit contenir au moins une majuscule, une minuscule et un chiffre"),terms:b.boolean().refine(s=>s===!0,{message:"Vous devez accepter les conditions d'utilisation"})}),fe=()=>{const[s,i]=n.useState(!1),[r,d]=n.useState(!1),h=Z(),{register:a}=$(),o=W({resolver:oe(ue),defaultValues:{firstName:"",lastName:"",email:"",password:"",terms:!1}}),l=async t=>{i(!0);try{await a({firstName:t.firstName,lastName:t.lastName,email:t.email,password:t.password}),D.success("Compte créé avec succès",{description:"Bienvenue sur ChezFlora ! Votre compte a été créé."}),h("/")}catch(u){console.error("Registration error:",u),D.error("Échec de la création du compte",{description:"Une erreur s'est produite. Veuillez réessayer."})}finally{i(!1)}},f=()=>d(!r);return e.jsx(Y,{title:"Créer un compte",description:"Rejoignez-nous pour accéder à toutes les fonctionnalités de notre boutique en ligne.",backLink:{href:"/auth/login",label:"Déjà un compte ? Se connecter"},children:e.jsx(ee,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(l),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(C,{control:o.control,name:"firstName",render:({field:t})=>e.jsxs(k,{children:[e.jsx(v,{children:"Prénom"}),e.jsx(g,{children:e.jsx(w,{placeholder:"Votre prénom",disabled:s,...t})}),e.jsx(y,{})]})}),e.jsx(C,{control:o.control,name:"lastName",render:({field:t})=>e.jsxs(k,{children:[e.jsx(v,{children:"Nom"}),e.jsx(g,{children:e.jsx(w,{placeholder:"Votre nom",disabled:s,...t})}),e.jsx(y,{})]})})]}),e.jsx(C,{control:o.control,name:"email",render:({field:t})=>e.jsxs(k,{children:[e.jsx(v,{children:"Email"}),e.jsx(g,{children:e.jsx(w,{placeholder:"votre@email.fr",type:"email",autoComplete:"email",disabled:s,...t})}),e.jsx(y,{})]})}),e.jsx(C,{control:o.control,name:"password",render:({field:t})=>e.jsxs(k,{children:[e.jsx(v,{children:"Mot de passe"}),e.jsx(g,{children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{placeholder:"Créez un mot de passe sécurisé",type:r?"text":"password",autoComplete:"new-password",disabled:s,...t}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",onClick:f,children:r?e.jsx(se,{size:16}):e.jsx(te,{size:16})})]})}),e.jsx(y,{})]})}),e.jsx(C,{control:o.control,name:"terms",render:({field:t})=>e.jsxs(k,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md p-4 border",children:[e.jsx(g,{children:e.jsx(K,{checked:t.value,onCheckedChange:t.onChange,disabled:s})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsxs(v,{className:"text-sm font-normal",children:["J'accepte les"," ",e.jsx(A,{to:"/terms",className:"text-primary hover:underline",children:"conditions d'utilisation"})," ","et la"," ",e.jsx(A,{to:"/privacy",className:"text-primary hover:underline",children:"politique de confidentialité"})]}),e.jsx(y,{})]})]})}),e.jsx(re,{type:"submit",className:"w-full",disabled:s,children:s?"Création du compte...":"Créer mon compte"})]})})})};export{fe as default};
