import{z as o,r as j,v,Q as S,j as e,x as C,y as n,D as a,E as i,G as l,I as d,K as c,B as z,M as g,O as b,J as h}from"./index-D2Ipw2YP.js";import{C as F,a as M,b as V,d as E,c as I}from"./card-CcKSh10K.js";const A=o.object({firstName:o.string().min(2,"Le prénom doit contenir au moins 2 caractères"),lastName:o.string().min(2,"Le nom doit contenir au moins 2 caractères"),email:o.string().email("Adresse email invalide"),phone:o.string().optional()}),B=o.object({currentPassword:o.string().min(1,"Le mot de passe actuel est requis"),newPassword:o.string().min(8,"Le mot de passe doit contenir au moins 8 caractères").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Le mot de passe doit contenir au moins une majuscule, une minuscule et un chiffre"),confirmPassword:o.string().min(1,"La confirmation du mot de passe est requise")}).refine(r=>r.newPassword===r.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]}),K=()=>{const[r,L]=j.useState(()=>{const s=localStorage.getItem("user");return s?JSON.parse(s):null}),[m,y]=j.useState(!1),[p,N]=j.useState(!1),[f,U]=j.useState(!1),[w,J]=j.useState(!1),[P,O]=j.useState(!1),u=v({resolver:S(A),defaultValues:{firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||""}}),x=v({resolver:S(B),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),T=async s=>{y(!0);try{await new Promise(q=>setTimeout(q,1e3));const t={...r,...s};localStorage.setItem("user",JSON.stringify(t)),L(t),h.success("Profil mis à jour",{description:"Vos informations personnelles ont été mises à jour avec succès."})}catch(t){console.error("Profile update error:",t),h.error("Échec de la mise à jour",{description:"Une erreur s'est produite. Veuillez réessayer."})}finally{y(!1)}},k=async s=>{N(!0);try{await new Promise(t=>setTimeout(t,1e3)),h.success("Mot de passe mis à jour",{description:"Votre mot de passe a été modifié avec succès."}),x.reset({currentPassword:"",newPassword:"",confirmPassword:""})}catch(t){console.error("Password update error:",t),h.error("Échec de la mise à jour",{description:"Une erreur s'est produite. Veuillez réessayer."})}finally{N(!1)}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-serif",children:"Mes informations"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez vos informations personnelles et vos préférences de compte."})]}),e.jsxs(F,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Informations personnelles"}),e.jsx(E,{children:"Mettez à jour vos informations de profil."})]}),e.jsx(I,{children:e.jsx(C,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(T),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:u.control,name:"firstName",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Prénom"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Votre prénom",disabled:m,...s})}),e.jsx(c,{})]})}),e.jsx(n,{control:u.control,name:"lastName",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Nom"}),e.jsx(l,{children:e.jsx(d,{placeholder:"Votre nom",disabled:m,...s})}),e.jsx(c,{})]})})]}),e.jsx(n,{control:u.control,name:"email",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Email"}),e.jsx(l,{children:e.jsx(d,{type:"email",placeholder:"votre@email.fr",disabled:m,...s})}),e.jsx(c,{})]})}),e.jsx(n,{control:u.control,name:"phone",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Téléphone"}),e.jsx(l,{children:e.jsx(d,{type:"tel",placeholder:"Votre numéro de téléphone",disabled:m,...s})}),e.jsx(c,{})]})}),e.jsx(z,{type:"submit",disabled:m,children:m?"Enregistrement...":"Enregistrer les modifications"})]})})})]}),e.jsxs(F,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Changer de mot de passe"}),e.jsx(E,{children:"Mettez à jour votre mot de passe pour sécuriser votre compte."})]}),e.jsx(I,{children:e.jsx(C,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(k),className:"space-y-4",children:[e.jsx(n,{control:x.control,name:"currentPassword",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Mot de passe actuel"}),e.jsx(l,{children:e.jsxs("div",{className:"relative",children:[e.jsx(d,{type:f?"text":"password",disabled:p,...s}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",onClick:()=>U(!f),children:f?e.jsx(g,{size:16}):e.jsx(b,{size:16})})]})}),e.jsx(c,{})]})}),e.jsx(n,{control:x.control,name:"newPassword",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Nouveau mot de passe"}),e.jsx(l,{children:e.jsxs("div",{className:"relative",children:[e.jsx(d,{type:w?"text":"password",disabled:p,...s}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",onClick:()=>J(!w),children:w?e.jsx(g,{size:16}):e.jsx(b,{size:16})})]})}),e.jsx(c,{})]})}),e.jsx(n,{control:x.control,name:"confirmPassword",render:({field:s})=>e.jsxs(a,{children:[e.jsx(i,{children:"Confirmer le mot de passe"}),e.jsx(l,{children:e.jsxs("div",{className:"relative",children:[e.jsx(d,{type:P?"text":"password",disabled:p,...s}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",onClick:()=>O(!P),children:P?e.jsx(g,{size:16}):e.jsx(b,{size:16})})]})}),e.jsx(c,{})]})}),e.jsx(z,{type:"submit",disabled:p,children:p?"Mise à jour...":"Mettre à jour le mot de passe"})]})})})]})]})};export{K as default};
