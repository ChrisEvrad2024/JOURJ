import{r as m,h,d as p,j as e,N as j,S as b,L as s,X as f,F as N,J as a}from"./index-D2Ipw2YP.js";import{M as g}from"./minus-DSzL0OlM.js";import{P as v}from"./plus--fUcP0bL.js";const k=()=>{const[d,c]=m.useState(!1),{currentUser:i}=h(),{cartItems:t=[],cartTotal:n=0,updateItemQuantity:o=()=>{},removeFromCart:l=()=>{},clearCart:y=()=>{},createOrder:u=async()=>{}}=p()||{},x=async()=>{if(!i){a.error("Vous devez être connecté",{description:"Veuillez vous connecter pour finaliser votre commande",duration:5e3});return}c(!0);try{const r=await u({shippingMethod:"standard",shippingCost:7.9,paymentMethod:"credit_card"});a.success("Commande créée avec succès",{description:`Votre commande #${r.orderNumber} a été créée.`,duration:5e3}),setTimeout(()=>{window.location.href=`/account/orders?highlight=${r.id}`},1500)}catch(r){console.error("Error creating order:",r),a.error("Échec de la commande",{description:r.message||"Une erreur est survenue. Veuillez réessayer.",duration:5e3})}finally{c(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(j,{}),e.jsx("main",{className:"pt-32 pb-16 min-h-screen",children:e.jsxs("div",{className:"section-container",children:[e.jsx("h1",{className:"text-3xl font-serif mb-8",children:"Votre Panier"}),!t||t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex justify-center items-center p-6 bg-muted rounded-full mb-6",children:e.jsx(b,{size:32,className:"text-muted-foreground"})}),e.jsx("h2",{className:"text-xl font-serif mb-4",children:"Votre panier est vide"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Ajoutez des produits à votre panier pour continuer vos achats."}),e.jsx(s,{to:"/catalog",className:"btn-primary inline-flex",children:"Continuer mes achats"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"bg-background rounded-lg border border-border overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-4 px-6",children:"Produit"}),e.jsx("th",{className:"text-center py-4 px-2",children:"Quantité"}),e.jsx("th",{className:"text-right py-4 px-6",children:"Prix"}),e.jsx("th",{className:"text-right py-4 px-6"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{className:"border-t border-border",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s,{to:`/product/${r.product.id}`,className:"w-20 h-20 rounded-md overflow-hidden bg-muted",children:e.jsx("img",{src:r.product.images[0],alt:r.product.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx(s,{to:`/product/${r.product.id}`,className:"font-medium hover:text-primary transition-colors",children:r.product.name}),e.jsxs("p",{className:"text-muted-foreground text-sm mt-1",children:[r.product.price.toFixed(2)," XAF / unité"]})]})]})}),e.jsx("td",{className:"py-4 px-2",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("button",{className:"border border-border rounded-l-md p-2 hover:bg-muted transition-colors",onClick:()=>o(r.product.id,r.quantity-1),disabled:r.quantity<=1,children:e.jsx(g,{size:14})}),e.jsx("div",{className:"border-t border-b border-border px-4 py-1.5 flex items-center justify-center min-w-[40px]",children:r.quantity}),e.jsx("button",{className:"border border-border rounded-r-md p-2 hover:bg-muted transition-colors",onClick:()=>o(r.product.id,r.quantity+1),disabled:r.product.stock!==void 0&&r.quantity>=r.product.stock,children:e.jsx(v,{size:14})})]})}),e.jsxs("td",{className:"py-4 px-6 text-right font-medium",children:[(r.product.price*r.quantity).toFixed(2)," XAF"]}),e.jsx("td",{className:"py-4 px-6 text-right",children:e.jsx("button",{className:"text-muted-foreground hover:text-destructive p-2 transition-colors rounded-full hover:bg-muted",onClick:()=>l(r.product.id),"aria-label":"Retirer du panier",children:e.jsx(f,{size:16})})})]},r.product.id))})]})})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-background rounded-lg border border-border p-6",children:[e.jsx("h2",{className:"text-xl font-serif mb-6",children:"Récapitulatif"}),e.jsxs("div",{className:"space-y-4 border-b border-border pb-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sous-total"}),e.jsxs("span",{className:"font-medium",children:[n.toFixed(2)," XAF"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Livraison"}),e.jsx("span",{className:"font-medium",children:"7.90 XAF"})]})]}),e.jsxs("div",{className:"flex justify-between mb-8",children:[e.jsx("span",{className:"text-lg",children:"Total"}),e.jsxs("span",{className:"text-lg font-medium",children:[(n+7.9).toFixed(2)," XAF"]})]}),e.jsx("button",{className:"btn-primary w-full flex items-center justify-center gap-2",onClick:x,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white rounded-full border-t-transparent"}),"Traitement..."]}):"Passer au paiement"}),e.jsx("div",{className:"mt-6",children:e.jsx(s,{to:"/catalog",className:"text-primary hover:underline text-sm flex justify-center",children:"Continuer vos achats"})})]})})]})]})}),e.jsx(N,{})]})};export{k as default};
