import{r as i,j as e,ae as oe,I as me,$ as z,a1 as xe,a2 as he,B as u,a3 as ue,a4 as H,O as je,C as pe,_ as b,J as y}from"./index-D2Ipw2YP.js";import{C as Ne,a as ge,c as fe,e as ve}from"./card-CcKSh10K.js";import{T as U,a as q,b as o,c as n,d as Q,e as r}from"./table-CBTVJ1-_.js";import{D as G,a as J,b as _,c as K,d as W,e as be}from"./dialog-Bh1R_dux.js";import{T as ye,a as we,b as j,c as p}from"./tabs-BkT1Db25.js";import{S as Ce}from"./separator-B4UgFw64.js";import{S as X,a as Y,b as Z,c as ee,d as l}from"./select-CkDa4oYz.js";import{T as Se}from"./textarea-BXYulBZ9.js";import{C as w}from"./clock-CXcy2a79.js";import{E as Ae}from"./ellipsis-vertical-CGtGoFNX.js";import{F as se}from"./file-pen-Ddvlinbf.js";import{R as ae}from"./refresh-cw-DCuin_Kt.js";import{T as Ee}from"./truck-B32u1BTN.js";import{C as Te}from"./circle-alert-cp0tzuw5.js";import{f as De}from"./format-BxPkkDNt.js";import{f as Fe}from"./fr-BSv8k3uD.js";import"./index-BycQlkId.js";import"./index-DByQH1EK.js";const c={pending:{label:"En attente",color:"bg-yellow-100 text-yellow-800",icon:e.jsx(w,{className:"h-4 w-4"})},processing:{label:"En traitement",color:"bg-blue-100 text-blue-800",icon:e.jsx(ae,{className:"h-4 w-4"})},shipped:{label:"Expédié",color:"bg-purple-100 text-purple-800",icon:e.jsx(Ee,{className:"h-4 w-4"})},delivered:{label:"Livré",color:"bg-green-100 text-green-800",icon:e.jsx(pe,{className:"h-4 w-4"})},cancelled:{label:"Annulé",color:"bg-red-100 text-red-800",icon:e.jsx(Te,{className:"h-4 w-4"})},refunded:{label:"Remboursé",color:"bg-gray-100 text-gray-800",icon:e.jsx(ae,{className:"h-4 w-4"})}},Ke=()=>{var O,k,L,I,R,$,V;const[N,C]=i.useState([]),[te,S]=i.useState(!0),[g,le]=i.useState(""),[d,re]=i.useState("all"),[s,A]=i.useState(null),[ie,E]=i.useState(!1),[ne,m]=i.useState(!1),[f,T]=i.useState(""),[D,F]=i.useState("");i.useEffect(()=>{(async()=>{try{S(!0);const t={};d!=="all"&&(t.status=d);const h=await b.getAllOrders(t);C(h)}catch(t){console.error("Error fetching orders:",t),y.error("Erreur lors du chargement des commandes")}finally{S(!1)}})()},[d]);const v=N.filter(a=>{if(!g)return!0;const t=g.toLowerCase();return a.id&&a.id.toString().toLowerCase().includes(t)||a.customerName&&a.customerName.toLowerCase().includes(t)||a.customerEmail&&a.customerEmail.toLowerCase().includes(t)||a.orderNumber&&a.orderNumber.toLowerCase().includes(t)}),x=a=>a?De(new Date(a),"dd MMMM yyyy",{locale:Fe}):"N/A",de=a=>{A(a),E(!0)},M=a=>{A(a),T(a.status),F(""),m(!0)},ce=async()=>{if(!(!s||!f))try{await b.updateOrderStatus(s.id,f,D);const a={};d!=="all"&&(a.status=d);const t=await b.getAllOrders(a);C(t),y.success("Statut mis à jour avec succès"),m(!1)}catch(a){console.error("Error updating order status:",a),y.error("Erreur lors de la mise à jour du statut")}};return te&&N.length===0?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Commandes"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les commandes de produits."})]})}),e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-10 bg-muted rounded-md w-full max-w-md"}),e.jsx("div",{className:"h-64 bg-muted rounded-md w-full"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Commandes"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les commandes de produits."})]})}),e.jsxs(Ne,{children:[e.jsx(ge,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx(oe,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(me,{type:"search",placeholder:"Rechercher une commande...",className:"pl-8",value:g,onChange:a=>le(a.target.value)})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs(X,{value:d,onValueChange:re,children:[e.jsx(Y,{className:"w-[180px]",children:e.jsx(Z,{placeholder:"Filtrer par statut"})}),e.jsxs(ee,{children:[e.jsx(l,{value:"all",children:"Tous les statuts"}),e.jsx(l,{value:"pending",children:"En attente"}),e.jsx(l,{value:"processing",children:"En traitement"}),e.jsx(l,{value:"shipped",children:"Expédié"}),e.jsx(l,{value:"delivered",children:"Livré"}),e.jsx(l,{value:"cancelled",children:"Annulé"}),e.jsx(l,{value:"refunded",children:"Remboursé"})]})]})})]})}),e.jsx(fe,{children:e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(U,{children:[e.jsx(q,{children:e.jsxs(o,{children:[e.jsx(n,{children:"Numéro"}),e.jsx(n,{children:"Client"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Montant"}),e.jsx(n,{className:"text-center",children:"Statut"}),e.jsx(n,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:v.length>0?v.map(a=>{var t,h,P,B;return e.jsxs(o,{children:[e.jsxs(r,{className:"font-medium",children:["#",a.orderNumber||a.id]}),e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{children:a.customerName}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.customerEmail})]})}),e.jsx(r,{children:x(a.createdAt)}),e.jsxs(r,{children:[((t=a.total)==null?void 0:t.toFixed(2))||"0.00"," €"]}),e.jsx(r,{className:"text-center",children:e.jsxs(z,{variant:"outline",className:`${((h=c[a.status])==null?void 0:h.color)||"bg-gray-100 text-gray-800"} flex gap-1 items-center mx-auto`,children:[((P=c[a.status])==null?void 0:P.icon)||e.jsx(w,{className:"h-4 w-4"}),((B=c[a.status])==null?void 0:B.label)||a.status]})}),e.jsx(r,{className:"text-right",children:e.jsxs(xe,{children:[e.jsx(he,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",children:e.jsx(Ae,{className:"h-4 w-4"})})}),e.jsxs(ue,{align:"end",children:[e.jsxs(H,{onClick:()=>de(a),children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"Voir détails"]}),e.jsxs(H,{onClick:()=>M(a),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Mettre à jour statut"]})]})]})})]},a.id)}):e.jsx(o,{children:e.jsx(r,{colSpan:6,className:"h-24 text-center",children:"Aucune commande trouvée."})})})]})})}),e.jsx(ve,{className:"flex items-center justify-between border-t p-4",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Affichage de ",v.length," sur ",N.length," commandes"]})})]}),e.jsx(G,{open:ie,onOpenChange:E,children:e.jsxs(J,{className:"sm:max-w-[700px]",children:[e.jsxs(_,{children:[e.jsx(K,{children:"Détails de la commande"}),e.jsx(W,{children:s&&`Commande #${s.orderNumber||s.id} • ${x(s==null?void 0:s.createdAt)}`})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(z,{variant:"outline",className:`${((O=c[s.status])==null?void 0:O.color)||"bg-gray-100 text-gray-800"} flex gap-1 items-center`,children:[((k=c[s.status])==null?void 0:k.icon)||e.jsx(w,{className:"h-4 w-4"}),((L=c[s.status])==null?void 0:L.label)||s.status]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(u,{size:"sm",onClick:()=>M(s),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Statut"]})})]}),e.jsxs(ye,{defaultValue:"details",children:[e.jsxs(we,{className:"mb-4",children:[e.jsx(j,{value:"details",children:"Détails"}),e.jsx(j,{value:"customer",children:"Client"}),e.jsx(j,{value:"items",children:"Articles"}),e.jsx(j,{value:"shipping",children:"Livraison"})]}),e.jsxs(p,{value:"details",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Informations générales"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Numéro de commande:"})," ",s.orderNumber||s.id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",x(s.createdAt)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Mode de paiement:"})," ",s.paymentMethod||"Non spécifié"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Montants"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Sous-total:"})," ",((I=s.subtotal)==null?void 0:I.toFixed(2))||"0.00"," €"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Frais de livraison:"})," ",((R=s.shippingFee)==null?void 0:R.toFixed(2))||"0.00"," €"]}),s.discount>0&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Remise:"})," ","-",(($=s.discount)==null?void 0:$.toFixed(2))||"0.00"," €"]}),e.jsx(Ce,{className:"my-1"}),e.jsxs("p",{className:"font-medium",children:["Total: ",((V=s.total)==null?void 0:V.toFixed(2))||"0.00"," €"]})]})]})]}),s.notes&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Notes"}),e.jsx("div",{className:"text-sm p-3 bg-muted/50 rounded-lg",children:s.notes})]})]}),e.jsxs(p,{value:"customer",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Informations client"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Nom:"})," ",s.customerName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",e.jsx("a",{href:`mailto:${s.customerEmail}`,className:"text-primary hover:underline",children:s.customerEmail})]}),s.customerPhone&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Téléphone:"})," ",e.jsx("a",{href:`tel:${s.customerPhone}`,className:"text-primary hover:underline",children:s.customerPhone})]})]})]}),s.billingAddress&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Adresse de facturation"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{children:s.billingAddress.line1}),s.billingAddress.line2&&e.jsx("p",{children:s.billingAddress.line2}),e.jsxs("p",{children:[s.billingAddress.postalCode," ",s.billingAddress.city]}),e.jsx("p",{children:s.billingAddress.country||"France"})]})]})]}),e.jsx(p,{value:"items",className:"space-y-4",children:s.items&&s.items.length>0?e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(U,{children:[e.jsx(q,{children:e.jsxs(o,{children:[e.jsx(n,{children:"Produit"}),e.jsx(n,{className:"text-center w-24",children:"Quantité"}),e.jsx(n,{className:"text-right w-24",children:"Prix"}),e.jsx(n,{className:"text-right w-32",children:"Total"})]})}),e.jsx(Q,{children:s.items.map((a,t)=>e.jsxs(o,{children:[e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{children:a.name}),a.variant&&e.jsx("div",{className:"text-xs text-muted-foreground",children:a.variant})]})}),e.jsx(r,{className:"text-center",children:a.quantity}),e.jsxs(r,{className:"text-right",children:[parseFloat(a.price).toFixed(2)," €"]}),e.jsxs(r,{className:"text-right",children:[(a.quantity*a.price).toFixed(2)," €"]})]},t))})]})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun article trouvé"})}),e.jsxs(p,{value:"shipping",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Informations de livraison"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Mode de livraison:"})," ",s.shippingMethod||"Standard"]}),s.trackingNumber&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Numéro de suivi:"})," ",s.trackingNumber]}),s.estimatedDelivery&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Livraison estimée:"})," ",x(s.estimatedDelivery)]})]})]}),s.shippingAddress&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Adresse de livraison"}),e.jsxs("div",{className:"text-sm p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{children:s.shippingAddress.line1}),s.shippingAddress.line2&&e.jsx("p",{children:s.shippingAddress.line2}),e.jsxs("p",{children:[s.shippingAddress.postalCode," ",s.shippingAddress.city]}),e.jsx("p",{children:s.shippingAddress.country||"France"})]})]}),s.deliveryInstructions&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Instructions de livraison"}),e.jsx("div",{className:"text-sm p-3 bg-muted/50 rounded-lg",children:s.deliveryInstructions})]})]})]})]})]})}),e.jsx(G,{open:ne,onOpenChange:m,children:e.jsxs(J,{children:[e.jsxs(_,{children:[e.jsx(K,{children:"Mettre à jour le statut"}),e.jsx(W,{children:s&&`Commande #${s.orderNumber||s.id}`})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Choisir un nouveau statut"}),e.jsxs(X,{value:f,onValueChange:T,children:[e.jsx(Y,{children:e.jsx(Z,{placeholder:"Sélectionner un statut"})}),e.jsxs(ee,{children:[e.jsx(l,{value:"pending",children:"En attente"}),e.jsx(l,{value:"processing",children:"En traitement"}),e.jsx(l,{value:"shipped",children:"Expédié"}),e.jsx(l,{value:"delivered",children:"Livré"}),e.jsx(l,{value:"cancelled",children:"Annulé"}),e.jsx(l,{value:"refunded",children:"Remboursé"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes (optionnel)"}),e.jsx(Se,{placeholder:"Ajouter des notes sur la mise à jour du statut",value:D,onChange:a=>F(a.target.value)})]})]}),e.jsxs(be,{children:[e.jsx(u,{variant:"outline",onClick:()=>m(!1),children:"Annuler"}),e.jsx(u,{onClick:ce,children:"Mettre à jour"})]})]})})]})};export{Ke as default};
